{"title":"Creating clustered bar graphs with R base graphics","markdown":{"yaml":{"title":"Creating clustered bar graphs with R base graphics","date":"2025-04-18","categories":["Data Visualization","R"],"tags":["barplots","R"]},"headingText":"**Pre-requisities**","containsRefs":false,"markdown":"\n\nA clustered bar graph is useful for comparing values across two categories of data. In this type of graph, we organize the bars in groups based on the levels of the first categorical variable. The height of each bar within a group represents the value of a level of the second categorical variable.\n\nYou can create this graph in R using the pre-installed base graphics package. This package has many plotting functions that are easy to use and excel at generating basic plots quickly. Use the command `library(help = “graphics”)` to get more information on this package, including a complete list of its functions.\n\n\nTo follow through with the activities in this article, you should have a working knowledge of R.\n\n## The Data\n\n```{=html}\n<table>\n  <caption>Table 1: Dummy sales data.</caption>\n  <thead>\n    <tr>\n      <th>Store</th>\n      <th>Product</th>\n      <th>Sales ($)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>A</td>\n      <td>P1</td>\n      <td>42,500</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P1</td>\n      <td>48,502</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P1</td>\n      <td>39,500</td>\n    </tr>\n    <tr>\n      <td>A</td>\n      <td>P2</td>\n      <td>43,600</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P2</td>\n      <td>32,303</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P2</td>\n      <td>29,500</td>\n    </tr>\n    <tr>\n      <td>A</td>\n      <td>P3</td>\n      <td>49,270</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P3</td>\n      <td>49,664</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P3</td>\n      <td>48,507</td>\n    </tr>\n  </tbody>\n</table>\n```\nTo create the graphs in this article, we use the dataset displayed in Table 1. In this dataset, Store and Product are categorical variables, while Sales is a numerical variable. You can use a clustered bar graph to compare the monthly sales of the three products across the three stores. The bars in this graph will be organized into three groups based on store levels, with each bar representing the sales figure for a specific product.\n\n## How to create the graph\n\n### Step 1: Reorganize the dataset\n\nWe use the `barplot()` function in the base graphics package to plot the clustered bar graph. However, we must reorganize the dataset into a wide format to use this function effectively. In this format, each unique product occupies a single row, and each cell corresponds to a sales figure. Currently, the dataset has a long format, with store and product values spread across multiple rows.\n\nThe `barplot()` function requires the dataset to be in vector or matrix form. In this exercise, we input the data as a matrix using the `matrix()` function.\n\nHere is the code:\n\n```{r}\nmydata <- matrix(c(42500, 48502, 39500, 43600, 32303, 29500, 49270, 49664, 48507), nrow = 3, byrow = TRUE)\nrownames(mydata) <- c(\"P1\", \"P2\", \"P3\")\ncolnames(mydata) <- c(\"A\", \"B\", \"C\")\nmydata\n```\n\nThe `matrix()` function has two crucial arguments, `nrow` and `byrow`. `nrow` specifies the number of rows in the matrix, while `byrow`, set to `TRUE`, indicates that the matrix is populated row by row.\n\n### Step 2: Create the graph\n\nThe code provided below uses the `barplot()` function to create the graph shown in @fig-1.\n\n```{r}\n#| label: fig-1\n#| fig-cap: \"Clustered bar graph created using barplot().\"\n\nbarplot(mydata, beside = TRUE, xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE)\n```\n\nAs demonstrated in the code, `barplot()` accepts several arguments. Use the command `?barplot` to obtain a complete list of the function’s arguments.\n\nThe argument `beside` must be set to `TRUE` to ensure the bars within groups appear side-by-side, creating the desired clustered bar graph. If set to `FALSE`, the bars will appear stacked on each other. Additionally, we use the `xlab` and `ylab` arguments to specify the labels for the graph’s x-axis and y-axis, respectively.\n\nBy setting the argument `legendtext` to `TRUE`, we create a legend for the graph. A legend is a crucial element of a clustered bar graph because it helps users associate bar colors with distinct data points.\n\n### Step 3: Customize the graph\n\nThe graph in @fig-1 is a basic clustered bar graph with few elements. We can enhance the graph’s clarity by adding colors, customizing the legend, adjusting the margins, and rescaling the y-axis.\n\n#### 1. Add colors\n\nWe use the `Pastel1` palette from the `RColorBrewer` package to color the bars of the graph based on product levels.\n\nIf you don’t already have this package installed, do so with the command `install.packages(\"RColorBrewer\")`.\n\nAfter installation, use the command `library(RColorBrewer)` to load the package.\n\nOnce loaded, you can access the `brewer.pal()` function and use it to create a vector of colors for your graph. This function takes two arguments: the number of colors and the name of the color palette. For a complete list of the palettes in `Rcolorbrewer`, use the command `display.brewer.all()`.\n\nWe use the following code to add colors and create the graph shown in @fig-2.\n\n```{r}\n#| label: fig-2\n#| fig-cap: \"Clustered bar graph with added product colors.\"\n\nlibrary(RColorBrewer)\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE)\n```\n\n#### 2. Customize the legend\n\nWe can enhance the legend of the graph in @fig-2 by\n\n-   Repositioning it to avoid blocking the bars.\n\n-   Removing the box around it.\n\n-   Adding a title.\n\nFor these adjustments, we pass the following arguments to `args.legend()` as a list:\n\n-   title = \"Product\": sets the title of the legend.\n\n-   x = \"right\": positions the legend to the right of the graph.\n\n-   bty = \"n\": suppresses the box around the legend, reducing clutter.\n\n-   inset = c(-0.16): shifts the legend 0.16 units to the right.\n\nThe adjustments result in the graph shown in @fig-3.\n\n```{r}\n#| label: fig-3\n#| fig-cap: \"Clustered bar graph with customized legend.\"\n\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n#### 3. Adjust the margins\n\n@fig-3 shows that the right margin lacks sufficient space for the legend. To resolve this problem, we increase the size of the right margin using the `par()` function with the `mai` argument, specifying the margin in inches. Use the command `par(\"mai\")` to check the plot’s default margin settings.\n\nAdditionally, we can use the `space` argument to reduce the space between the groups of bars, thus creating more room in the right margin. This argument accepts two values. The first value indicates the space between bars within a group, while the second value denotes the space between groups of bars. These changes result in the graph in @fig-4.\n\n```{r}\n#| label: fig-4\n#| fig-cap: \"Clustered bar graph with adjusted margins.\"\n\npar(mai=c(1, 1, 1, 1.2))\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), space = c(0, 0.6), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n#### 4. Rescale the y-axis\n\nWe use the `ylim` argument to specify the range of the y-axis. This argument accepts a vector containing the smallest and largest values on the y-axis. Here is the code used to create the graph shown in @fig-5.\n\n```{r}\n#| label: fig-5\n#| fig-cap: \"Clustered bar graph with various modifications.\"\n\npar(mai=c(1, 1, 1, 1.2))\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), space = c(0, 0.6), xlab = \"Store\", ylab = \"Sales ($)\", ylim = c(0, 60000), legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n## Conclusion\n\nThis article has shown that you can create a visually appealing and effective clustered bar graph using the `barplot()` function from R’s base graphics package. The function has several arguments that allow you to customize the graph’s appearance to meet your needs. While graphing, remember that simplicity and clarity are crucial to effectively communicating your data to viewers.\n","srcMarkdownNoYaml":"\n\nA clustered bar graph is useful for comparing values across two categories of data. In this type of graph, we organize the bars in groups based on the levels of the first categorical variable. The height of each bar within a group represents the value of a level of the second categorical variable.\n\nYou can create this graph in R using the pre-installed base graphics package. This package has many plotting functions that are easy to use and excel at generating basic plots quickly. Use the command `library(help = “graphics”)` to get more information on this package, including a complete list of its functions.\n\n## **Pre-requisities**\n\nTo follow through with the activities in this article, you should have a working knowledge of R.\n\n## The Data\n\n```{=html}\n<table>\n  <caption>Table 1: Dummy sales data.</caption>\n  <thead>\n    <tr>\n      <th>Store</th>\n      <th>Product</th>\n      <th>Sales ($)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>A</td>\n      <td>P1</td>\n      <td>42,500</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P1</td>\n      <td>48,502</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P1</td>\n      <td>39,500</td>\n    </tr>\n    <tr>\n      <td>A</td>\n      <td>P2</td>\n      <td>43,600</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P2</td>\n      <td>32,303</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P2</td>\n      <td>29,500</td>\n    </tr>\n    <tr>\n      <td>A</td>\n      <td>P3</td>\n      <td>49,270</td>\n    </tr>\n    <tr>\n      <td>B</td>\n      <td>P3</td>\n      <td>49,664</td>\n    </tr>\n    <tr>\n      <td>C</td>\n      <td>P3</td>\n      <td>48,507</td>\n    </tr>\n  </tbody>\n</table>\n```\nTo create the graphs in this article, we use the dataset displayed in Table 1. In this dataset, Store and Product are categorical variables, while Sales is a numerical variable. You can use a clustered bar graph to compare the monthly sales of the three products across the three stores. The bars in this graph will be organized into three groups based on store levels, with each bar representing the sales figure for a specific product.\n\n## How to create the graph\n\n### Step 1: Reorganize the dataset\n\nWe use the `barplot()` function in the base graphics package to plot the clustered bar graph. However, we must reorganize the dataset into a wide format to use this function effectively. In this format, each unique product occupies a single row, and each cell corresponds to a sales figure. Currently, the dataset has a long format, with store and product values spread across multiple rows.\n\nThe `barplot()` function requires the dataset to be in vector or matrix form. In this exercise, we input the data as a matrix using the `matrix()` function.\n\nHere is the code:\n\n```{r}\nmydata <- matrix(c(42500, 48502, 39500, 43600, 32303, 29500, 49270, 49664, 48507), nrow = 3, byrow = TRUE)\nrownames(mydata) <- c(\"P1\", \"P2\", \"P3\")\ncolnames(mydata) <- c(\"A\", \"B\", \"C\")\nmydata\n```\n\nThe `matrix()` function has two crucial arguments, `nrow` and `byrow`. `nrow` specifies the number of rows in the matrix, while `byrow`, set to `TRUE`, indicates that the matrix is populated row by row.\n\n### Step 2: Create the graph\n\nThe code provided below uses the `barplot()` function to create the graph shown in @fig-1.\n\n```{r}\n#| label: fig-1\n#| fig-cap: \"Clustered bar graph created using barplot().\"\n\nbarplot(mydata, beside = TRUE, xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE)\n```\n\nAs demonstrated in the code, `barplot()` accepts several arguments. Use the command `?barplot` to obtain a complete list of the function’s arguments.\n\nThe argument `beside` must be set to `TRUE` to ensure the bars within groups appear side-by-side, creating the desired clustered bar graph. If set to `FALSE`, the bars will appear stacked on each other. Additionally, we use the `xlab` and `ylab` arguments to specify the labels for the graph’s x-axis and y-axis, respectively.\n\nBy setting the argument `legendtext` to `TRUE`, we create a legend for the graph. A legend is a crucial element of a clustered bar graph because it helps users associate bar colors with distinct data points.\n\n### Step 3: Customize the graph\n\nThe graph in @fig-1 is a basic clustered bar graph with few elements. We can enhance the graph’s clarity by adding colors, customizing the legend, adjusting the margins, and rescaling the y-axis.\n\n#### 1. Add colors\n\nWe use the `Pastel1` palette from the `RColorBrewer` package to color the bars of the graph based on product levels.\n\nIf you don’t already have this package installed, do so with the command `install.packages(\"RColorBrewer\")`.\n\nAfter installation, use the command `library(RColorBrewer)` to load the package.\n\nOnce loaded, you can access the `brewer.pal()` function and use it to create a vector of colors for your graph. This function takes two arguments: the number of colors and the name of the color palette. For a complete list of the palettes in `Rcolorbrewer`, use the command `display.brewer.all()`.\n\nWe use the following code to add colors and create the graph shown in @fig-2.\n\n```{r}\n#| label: fig-2\n#| fig-cap: \"Clustered bar graph with added product colors.\"\n\nlibrary(RColorBrewer)\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE)\n```\n\n#### 2. Customize the legend\n\nWe can enhance the legend of the graph in @fig-2 by\n\n-   Repositioning it to avoid blocking the bars.\n\n-   Removing the box around it.\n\n-   Adding a title.\n\nFor these adjustments, we pass the following arguments to `args.legend()` as a list:\n\n-   title = \"Product\": sets the title of the legend.\n\n-   x = \"right\": positions the legend to the right of the graph.\n\n-   bty = \"n\": suppresses the box around the legend, reducing clutter.\n\n-   inset = c(-0.16): shifts the legend 0.16 units to the right.\n\nThe adjustments result in the graph shown in @fig-3.\n\n```{r}\n#| label: fig-3\n#| fig-cap: \"Clustered bar graph with customized legend.\"\n\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n#### 3. Adjust the margins\n\n@fig-3 shows that the right margin lacks sufficient space for the legend. To resolve this problem, we increase the size of the right margin using the `par()` function with the `mai` argument, specifying the margin in inches. Use the command `par(\"mai\")` to check the plot’s default margin settings.\n\nAdditionally, we can use the `space` argument to reduce the space between the groups of bars, thus creating more room in the right margin. This argument accepts two values. The first value indicates the space between bars within a group, while the second value denotes the space between groups of bars. These changes result in the graph in @fig-4.\n\n```{r}\n#| label: fig-4\n#| fig-cap: \"Clustered bar graph with adjusted margins.\"\n\npar(mai=c(1, 1, 1, 1.2))\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), space = c(0, 0.6), xlab = \"Store\", ylab = \"Sales ($)\", legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n#### 4. Rescale the y-axis\n\nWe use the `ylim` argument to specify the range of the y-axis. This argument accepts a vector containing the smallest and largest values on the y-axis. Here is the code used to create the graph shown in @fig-5.\n\n```{r}\n#| label: fig-5\n#| fig-cap: \"Clustered bar graph with various modifications.\"\n\npar(mai=c(1, 1, 1, 1.2))\nbarplot(mydata, beside = TRUE, col = brewer.pal(3, name = \"Pastel1\"), space = c(0, 0.6), xlab = \"Store\", ylab = \"Sales ($)\", ylim = c(0, 60000), legend.text = TRUE, args.legend = list(title = \"Product\", x = \"right\", bty = \"n\", inset = -0.16))\n```\n\n## Conclusion\n\nThis article has shown that you can create a visually appealing and effective clustered bar graph using the `barplot()` function from R’s base graphics package. The function has several arguments that allow you to customize the graph’s appearance to meet your needs. While graphing, remember that simplicity and clarity are crucial to effectively communicating your data to viewers.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"toc-depth":2,"output-file":"clustered-barplots-r.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.40","theme":"flatly","toc-location":"left","title":"Creating clustered bar graphs with R base graphics","date":"2025-04-18","categories":["Data Visualization","R"],"tags":["barplots","R"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}